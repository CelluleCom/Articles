<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning Éditorial Grist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://grist.getgrist.com/grist-api.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .editor-textarea {
            resize: none;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent;
        }
        .editor-textarea::-webkit-scrollbar { width: 6px; }
        .editor-textarea::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "recharts": "https://esm.sh/recharts@2.12.7",
        "htm": "https://esm.sh/htm@3.1.1"
      }
    }
    </script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-slate-50 text-slate-900 h-screen overflow-hidden">
    <div id="root" class="h-full"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo } from 'react';
        import ReactDOM from 'react-dom/client';
        import htm from 'htm';
        import { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, 
            PieChart, Pie, Cell, AreaChart, Area 
        } from 'recharts';

        const html = htm.bind(React.createElement);

        // --- TYPES & ENUMS ---
        const ArticleStatus = {
            VALIDE: 'Validé',
            REPORTE: 'Reporté',
            EN_COURS: 'En cours',
            PUBLIE: 'Publié',
            ANNULE: 'Annulé'
        };

        const ARTICLE_TYPES = ['Blog', 'Tuto', 'Enquête', 'Interview', 'Opinion', 'News'];

        // --- UTILS ---
        const exportToCSV = (articles) => {
            const headers = ['titre', 'type', 'redacteur', 'status', 'datePublication', 'contenu'];
            const rows = articles.map(a => [
                a.titre, 
                a.type, 
                a.redacteur, 
                a.status, 
                a.datePublication,
                (a.contenu || '').replace(/,/g, ' ')
            ].join(','));
            const csvContent = [headers.join(','), ...rows].join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `planning_editorial_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        };

        // --- COMPONENTS ---

        const StatusBadge = ({ status }) => {
            const styles = {
                [ArticleStatus.VALIDE]: 'bg-indigo-100 text-indigo-700 border-indigo-200',
                [ArticleStatus.REPORTE]: 'bg-amber-100 text-amber-700 border-amber-200',
                [ArticleStatus.EN_COURS]: 'bg-blue-100 text-blue-700 border-blue-200',
                [ArticleStatus.PUBLIE]: 'bg-emerald-100 text-emerald-700 border-emerald-200',
                [ArticleStatus.ANNULE]: 'bg-rose-100 text-rose-700 border-rose-200'
            };
            return html`
                <span className=${`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold border ${styles[status] || styles[ArticleStatus.EN_COURS]}`}>
                    <span className="w-1.5 h-1.5 rounded-full bg-current mr-1.5" />
                    ${status}
                </span>
            `;
        };

        const ArticleEditorModal = ({ isOpen, onClose, onSave, article }) => {
            if (!isOpen) return null;
            
            const [formData, setFormData] = useState({
                titre: '',
                type: 'Blog',
                redacteur: '',
                status: ArticleStatus.EN_COURS,
                datePublication: new Date().toISOString().split('T')[0],
                contenu: ''
            });

            useEffect(() => {
                if (article) {
                    setFormData({
                        ...article,
                        datePublication: article.datePublication ? new Date(article.datePublication).toISOString().split('T')[0] : ''
                    });
                } else {
                    setFormData({
                        titre: '',
                        type: 'Blog',
                        redacteur: '',
                        status: ArticleStatus.EN_COURS,
                        datePublication: new Date().toISOString().split('T')[0],
                        contenu: ''
                    });
                }
            }, [article]);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
                onClose();
            };

            const wordCount = formData.contenu ? formData.contenu.trim().split(/\s+/).length : 0;

            return html`
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm">
                    <div className="bg-white rounded-3xl w-full max-w-5xl h-[85vh] shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200">
                        <div className="p-6 border-b flex justify-between items-center bg-white shrink-0">
                            <div>
                                <h2 className="text-xl font-bold text-slate-800">${article ? 'Édition de l\'article' : 'Rédiger un nouvel article'}</h2>
                                <p className="text-xs text-slate-400 mt-1">${wordCount} mots</p>
                            </div>
                            <button onClick=${onClose} className="p-2 hover:bg-slate-100 rounded-full transition">
                                <svg className="w-6 h-6 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"/></svg>
                            </button>
                        </div>
                        
                        <form onSubmit=${handleSubmit} className="flex-1 flex overflow-hidden">
                            <!-- Sidebar Édition -->
                            <div className="w-80 border-r bg-slate-50/50 p-6 space-y-6 overflow-y-auto shrink-0">
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Titre</label>
                                    <input required type="text" value=${formData.titre} onChange=${e => setFormData({...formData, titre: e.target.value})} className="w-full px-4 py-2 bg-white border rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition" />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Type</label>
                                    <select value=${formData.type} onChange=${e => setFormData({...formData, type: e.target.value})} className="w-full px-4 py-2 bg-white border rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition">
                                        ${ARTICLE_TYPES.map(t => html`<option key=${t} value=${t}>${t}</option>`)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Statut</label>
                                    <select value=${formData.status} onChange=${e => setFormData({...formData, status: e.target.value})} className="w-full px-4 py-2 bg-white border rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition">
                                        ${Object.values(ArticleStatus).map(s => html`<option key=${s} value=${s}>${s}</option>`)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Date de Publication</label>
                                    <input type="date" value=${formData.datePublication} onChange=${e => setFormData({...formData, datePublication: e.target.value})} className="w-full px-4 py-2 bg-white border rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition" />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Rédacteur</label>
                                    <input type="text" value=${formData.redacteur} onChange=${e => setFormData({...formData, redacteur: e.target.value})} className="w-full px-4 py-2 bg-white border rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition" />
                                </div>
                                <div className="pt-4 border-t">
                                    <button type="submit" className="w-full px-4 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 transition shadow-lg shadow-indigo-200">
                                        Enregistrer
                                    </button>
                                </div>
                            </div>

                            <!-- Zone de Rédaction -->
                            <div className="flex-1 flex flex-col p-8 bg-white overflow-hidden">
                                <textarea 
                                    className="flex-1 w-full p-4 editor-textarea text-lg text-slate-700 outline-none border-none placeholder:text-slate-300 font-serif leading-relaxed" 
                                    placeholder="Commencez à rédiger votre article ici..."
                                    value=${formData.contenu}
                                    onChange=${e => setFormData({...formData, contenu: e.target.value})}
                                ></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        };

        const Sidebar = ({ currentView, onViewChange, onExport, onNewArticle }) => html`
            <aside className="w-64 bg-slate-900 text-white flex flex-col h-full shrink-0">
                <div className="p-6 flex items-center space-x-3">
                    <div className="w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center">
                        <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10l4 4v10a2 2 0 01-2 2z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 2v4a2 2 0 002 2h4" /></svg>
                    </div>
                    <span className="font-bold text-lg tracking-tight">Grist Edit</span>
                </div>
                
                <div className="px-4 mb-6">
                    <button onClick=${onNewArticle} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-4 rounded-xl font-bold flex items-center justify-center space-x-2 transition shadow-lg shadow-indigo-900/40">
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 4v16m8-8H4"/></svg>
                        <span>Rédiger</span>
                    </button>
                </div>

                <nav className="flex-1 px-4 space-y-1">
                    ${['planning', 'calendar', 'stats'].map(view => html`
                        <button key=${view} onClick=${() => onViewChange(view)} className=${`w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition ${currentView === view ? 'bg-slate-800 text-white' : 'text-slate-400 hover:bg-slate-800/50 hover:text-white'}`}>
                            <div className=${`w-1.5 h-1.5 rounded-full ${currentView === view ? 'bg-indigo-400' : 'bg-transparent'}`} />
                            <span className="capitalize">${view === 'stats' ? 'Statistiques' : view === 'planning' ? 'Planning' : 'Calendrier'}</span>
                        </button>
                    `)}
                </nav>
                <div className="p-4 border-t border-slate-800">
                    <button onClick=${onExport} className="w-full text-left px-4 py-2 text-sm font-medium text-slate-400 hover:text-white transition">Exporter CSV</button>
                </div>
            </aside>
        `;

        const MonthGroup = ({ title, articles, defaultOpen, onEditArticle }) => {
            const [isOpen, setIsOpen] = useState(defaultOpen);
            if (!articles || articles.length === 0) return null;
            return html`
                <div className="border rounded-2xl overflow-hidden bg-white shadow-sm mb-4">
                    <button onClick=${() => setIsOpen(!isOpen)} className="w-full flex items-center justify-between p-4 bg-white hover:bg-slate-50 transition">
                        <div className="flex items-center space-x-3">
                            <div className="w-2 h-8 rounded-full bg-indigo-500" />
                            <h3 className="font-bold text-lg text-slate-800">${title}</h3>
                            <span className="text-sm bg-slate-100 px-2 py-0.5 rounded text-slate-500">${articles.length} article(s)</span>
                        </div>
                        <svg className=${`w-5 h-5 text-slate-400 transition ${isOpen ? 'rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/></svg>
                    </button>
                    ${isOpen && html`
                        <div className="overflow-x-auto border-t">
                            <table className="w-full text-left text-sm">
                                <thead className="bg-slate-50 text-slate-500 font-medium border-b uppercase text-xs">
                                    <tr>
                                        <th className="px-6 py-3">Statut</th>
                                        <th className="px-6 py-3">Titre</th>
                                        <th className="px-6 py-3">Type</th>
                                        <th className="px-6 py-3 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-100">
                                    ${articles.map((article) => html`
                                        <tr key=${article.id} className="hover:bg-slate-50/80 transition cursor-pointer" onClick=${() => onEditArticle(article)}>
                                            <td className="px-6 py-4"><${StatusBadge} status=${article.status} /></td>
                                            <td className="px-6 py-4">
                                                <div className="font-semibold text-slate-700">${article.titre}</div>
                                                <div className="text-xs text-slate-400">${article.redacteur || 'Sans auteur'} • ${article.contenu ? article.contenu.length : 0} caractères</div>
                                            </td>
                                            <td className="px-6 py-4 text-slate-500">${article.type}</td>
                                            <td className="px-6 py-4 text-right">
                                                <button onClick=${(e) => {e.stopPropagation(); onEditArticle(article);}} className="p-2 text-slate-400 hover:text-indigo-600 transition">
                                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                                                </button>
                                            </td>
                                        </tr>
                                    `)}
                                </tbody>
                            </table>
                        </div>
                    `}
                </div>
            `;
        };

        const PlanningView = ({ articles, onEditArticle }) => {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const grouped = useMemo(() => {
                const months = {};
                const published = [];
                const cancelled = [];
                articles.forEach((article) => {
                    if (article.status === ArticleStatus.PUBLIE) published.push(article);
                    else if (article.status === ArticleStatus.ANNULE) cancelled.push(article);
                    else {
                        const date = article.datePublication ? new Date(article.datePublication) : null;
                        const key = (date && !isNaN(date.getTime())) ? `${date.getFullYear()}-${date.getMonth()}` : 'Sans date';
                        if (!months[key]) months[key] = [];
                        months[key].push(article);
                    }
                });
                return { months, published, cancelled };
            }, [articles]);

            const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

            return html`
                <div className="space-y-8">
                    <section>
                        <h2 className="text-sm font-semibold text-slate-400 uppercase mb-4 tracking-wider">Planning Actif</h2>
                        ${Object.entries(grouped.months).sort((a,b) => b[0].localeCompare(a[0])).map(([key, items]) => {
                            const parts = key.split('-');
                            const year = parts.length === 2 ? parseInt(parts[0]) : null;
                            const month = parts.length === 2 ? parseInt(parts[1]) : null;
                            return html`<${MonthGroup} key=${key} onEditArticle=${onEditArticle} title=${key === 'Sans date' ? "À planifier" : `${monthNames[month]} ${year}`} articles=${items} defaultOpen=${year === currentYear && month === currentMonth} />`;
                        })}
                    </section>
                    <section>
                        <h2 className="text-sm font-semibold text-slate-400 uppercase mb-4 tracking-wider">Archives</h2>
                        <${MonthGroup} onEditArticle=${onEditArticle} title="Publiés" articles=${grouped.published} defaultOpen=${false} />
                    </section>
                </div>
            `;
        };

        const CalendarView = ({ articles, onEditArticle }) => {
            const [viewDate, setViewDate] = useState(new Date());
            const month = viewDate.getMonth();
            const year = viewDate.getFullYear();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDay = (new Date(year, month, 1).getDay() + 6) % 7; 
            const monthName = new Intl.DateTimeFormat('fr-FR', { month: 'long', year: 'numeric' }).format(viewDate);

            const articlesByDay = useMemo(() => {
                const map = {};
                articles.forEach((a) => {
                    if (!a.datePublication) return;
                    const d = new Date(a.datePublication);
                    if (d.getMonth() === month && d.getFullYear() === year) {
                        const day = d.getDate();
                        if (!map[day]) map[day] = [];
                        map[day].push(a);
                    }
                });
                return map;
            }, [articles, month, year]);

            return html`
                <div className="bg-white rounded-3xl border shadow-sm overflow-hidden flex flex-col h-full">
                    <div className="p-6 border-b flex justify-between items-center bg-white shrink-0">
                        <h2 className="text-2xl font-bold capitalize text-slate-800">${monthName}</h2>
                        <div className="flex space-x-2">
                            <button onClick=${() => setViewDate(new Date(year, month - 1, 1))} className="p-2 border rounded-lg hover:bg-slate-50 transition">Précédent</button>
                            <button onClick=${() => setViewDate(new Date())} className="px-4 py-2 border rounded-lg hover:bg-slate-50 transition text-sm font-medium">Aujourd'hui</button>
                            <button onClick=${() => setViewDate(new Date(year, month + 1, 1))} className="p-2 border rounded-lg hover:bg-slate-50 transition">Suivant</button>
                        </div>
                    </div>
                    <div className="grid grid-cols-7 border-b bg-slate-50/50 text-center text-xs font-bold text-slate-400 py-3 uppercase tracking-widest shrink-0">
                        ${['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'].map(d => html`<div key=${d}>${d}</div>`)}
                    </div>
                    <div className="flex-1 grid grid-cols-7 overflow-y-auto min-h-0">
                        ${Array.from({ length: firstDay }).map((_, i) => html`<div key=${`empty-${i}`} className="border-r border-b bg-slate-50/30 min-h-[120px]" />`)}
                        ${Array.from({ length: daysInMonth }).map((_, i) => {
                            const day = i + 1;
                            const dayArticles = articlesByDay[day] || [];
                            return html`
                                <div key=${day} className="border-r border-b p-3 min-h-[120px] hover:bg-slate-50/50 transition relative group">
                                    <span className="text-sm font-bold text-slate-400">${day}</span>
                                    <div className="mt-2 space-y-1">
                                        ${dayArticles.map(art => html`
                                            <div onClick=${() => onEditArticle(art)} key=${art.id} className="text-[10px] p-1.5 bg-indigo-50 text-indigo-700 rounded-lg border border-indigo-100 truncate cursor-pointer hover:bg-indigo-100 transition shadow-sm">
                                                ${art.titre}
                                            </div>
                                        `)}
                                    </div>
                                </div>
                            `;
                        })}
                    </div>
                </div>
            `;
        };

        const StatsView = ({ articles }) => {
            const stats = useMemo(() => {
                const statusCounts = articles.reduce((acc, a) => { acc[a.status] = (acc[a.status] || 0) + 1; return acc; }, {});
                const statusData = Object.entries(statusCounts).map(([name, value]) => ({ name, value }));
                return { statusData };
            }, [articles]);

            const COLORS = ['#6366f1', '#fbbf24', '#3b82f6', '#10b981', '#f43f5e'];

            return html`
                <div className="space-y-8">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="bg-white p-8 rounded-3xl border shadow-sm">
                            <p className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Total Articles</p>
                            <p className="text-4xl font-black text-slate-800">${articles.length}</p>
                        </div>
                        <div className="bg-white p-8 rounded-3xl border shadow-sm">
                            <p className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Volume Texte (caractères)</p>
                            <p className="text-4xl font-black text-slate-800">${articles.reduce((acc, a) => acc + (a.contenu || '').length, 0).toLocaleString()}</p>
                        </div>
                    </div>
                    <div className="bg-white p-8 rounded-3xl border shadow-sm h-[400px]">
                        <h3 className="font-bold mb-6 text-slate-800">Répartition du flux de travail</h3>
                        <${ResponsiveContainer} width="100%" height="100%">
                            <${PieChart}>
                                <${Pie} data=${stats.statusData} innerRadius=${80} outerRadius=${120} dataKey="value" paddingAngle=${5}>
                                    ${stats.statusData.map((e, i) => html`<${Cell} key=${i} fill=${COLORS[i % COLORS.length]} cornerRadius=${10} />`)}
                                <//>
                                <${Tooltip} />
                            <//>
                        <//>
                    </div>
                </div>
            `;
        };

        const App = () => {
            const [articles, setArticles] = useState([]);
            const [view, setView] = useState('planning');
            const [demo, setDemo] = useState(false);
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingArticle, setEditingArticle] = useState(null);

            useEffect(() => {
                const grist = window.grist;
                if (!grist) {
                    setArticles([]);
                    setDemo(true);
                    return;
                }
                grist.ready({ 
                    columns: ['titre', 'type', 'redacteur', 'status', 'datePublication', 'contenu'], 
                    requiredAccess: 'full' 
                });
                grist.onRecords((records) => {
                    const formatted = records.map(r => ({
                        id: r.id,
                        titre: r.titre || '',
                        type: r.type || 'Blog',
                        redacteur: r.redacteur || '',
                        status: r.status || ArticleStatus.EN_COURS,
                        datePublication: r.datePublication ? (typeof r.datePublication === 'number' ? new Date(r.datePublication * 1000).toISOString() : r.datePublication) : '',
                        contenu: r.contenu || ''
                    }));
                    setArticles(formatted);
                });
            }, []);

            const handleSaveArticle = async (articleData) => {
                const grist = window.grist;
                const record = {
                    titre: articleData.titre,
                    type: articleData.type,
                    redacteur: articleData.redacteur,
                    status: articleData.status,
                    datePublication: articleData.datePublication ? new Date(articleData.datePublication).getTime() / 1000 : null,
                    contenu: articleData.contenu
                };

                if (demo) {
                    if (editingArticle) {
                        setArticles(articles.map(a => a.id === editingArticle.id ? { ...articleData, id: a.id } : a));
                    } else {
                        setArticles([...articles, { ...articleData, id: Date.now() }]);
                    }
                } else {
                    try {
                        const table = await grist.getTable();
                        if (editingArticle) {
                            await table.updateRecords([{ id: editingArticle.id, ...record }]);
                        } else {
                            await table.addRecords([record]);
                        }
                    } catch (err) {
                        console.error("Erreur Grist:", err);
                        // Fallback local
                        if (editingArticle) {
                            setArticles(articles.map(a => a.id === editingArticle.id ? { ...articleData, id: a.id } : a));
                        } else {
                            setArticles([...articles, { ...articleData, id: Date.now() }]);
                        }
                    }
                }
            };

            const handleNewArticle = () => {
                setEditingArticle(null);
                setIsModalOpen(true);
            };

            const handleEditArticle = (article) => {
                setEditingArticle(article);
                setIsModalOpen(true);
            };

            return html`
                <div className="flex h-full w-full overflow-hidden">
                    <${Sidebar} 
                        currentView=${view} 
                        onViewChange=${setView} 
                        onExport=${() => exportToCSV(articles)} 
                        onNewArticle=${handleNewArticle}
                    />
                    <main className="flex-1 flex flex-col min-w-0">
                        <header className="bg-white border-b px-8 py-4 flex justify-between items-center shadow-sm shrink-0">
                            <div className="flex items-center space-x-3">
                                <h1 className="text-xl font-bold text-slate-800">Grist Editorial Studio</h1>
                                ${demo && html`<span className="text-[10px] bg-amber-100 text-amber-700 font-bold px-2 py-1 rounded">DÉMO</span>`}
                            </div>
                            <div className="text-sm font-medium text-slate-500 bg-slate-100 px-3 py-1 rounded-full">${articles.length} articles</div>
                        </header>
                        <div className="flex-1 overflow-auto p-8">
                            ${view === 'planning' && html`<${PlanningView} articles=${articles} onEditArticle=${handleEditArticle} />`}
                            ${view === 'calendar' && html`<${CalendarView} articles=${articles} onEditArticle=${handleEditArticle} />`}
                            ${view === 'stats' && html`<${StatsView} articles=${articles} />`}
                        </div>
                    </main>

                    <${ArticleEditorModal} 
                        isOpen=${isModalOpen} 
                        article=${editingArticle}
                        onClose=${() => setIsModalOpen(false)} 
                        onSave=${handleSaveArticle} 
                    />
                </div>
            `;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(html`<${App} />`);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>